<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Inventario</title>
  <link rel="stylesheet" href="Styles%20css/estilo.css">
  <style>
    #cargando, #contenido {
      display: none;
    }
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #555;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="login">
    <h2>BIENVENIDO</h2>
    <input type="text" id="usuario" placeholder="Usuario">
    <input type="password" id="contrasena" placeholder="ContraseÃ±a">
    <button onclick="iniciarSesion()">Entrar</button>
    <p id="mensaje" style="color: red;"></p>
  </div>

  <div id="cargando">
    <h2>Iniciando sesiÃ³n...</h2>
    <div class="spinner"></div>
  </div>

  <div id="contenido">
    <h1>GarantÃ­a 1.1</h1>
    <h1>Yo Smart</h1>

    <button class="exportar" onclick="exportTableToExcel('inventario', 'inventario_excel')">ðŸ“… Exportar a Excel</button>

    <table id="inventario">
      <thead>
        <tr>
          <th>FECHA DE ENTRADA</th>
          <th>EQUIPO</th>
          <th>IMEL</th>
          <th>PROBLEMA</th>
          <th>CLIENTE</th>
          <th>CEDULA</th>
          <th>TECNICO</th>
          <th>FECHA DE SALIDA</th>
          <th>ACCIÃ“N</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>23/04/2025</td>
          <td>IPHONE 11 64GB</td>
          <td>352908118265790</td>
          <td>BATERIA</td>
          <td>TANIS ADENS</td>
          <td>R12132473</td>
          <td>Maicol</td>
          <td>23/04/2025</td>
          <td><button class="eliminar" onclick="eliminarFila(this)">Eliminar</button></td>
        </tr>
      </tbody>
    </table>

    <div class="formulario">
      <h2>Agregar nuevo registro</h2>
      <input type="text" id="fechaEntrada" placeholder="Fecha de Entrada">
      <input type="text" id="equipo" placeholder="Equipo">
      <input type="text" id="imel" placeholder="IMEL">
      <input type="text" id="problema" placeholder="Problema">
      <input type="text" id="cliente" placeholder="Cliente">
      <input type="text" id="cedula" placeholder="CÃ©dula">
      <input type="text" id="tecnico" placeholder="TÃ©cnico">
      <input type="text" id="fechaSalida" placeholder="Fecha de Salida">
      <br>
      <button onclick="agregarRegistro()">âž• Agregar al Inventario</button>
    </div>
  </div>

  <script>
    function iniciarSesion() {
      const user = document.getElementById('usuario').value;
      const pass = document.getElementById('contrasena').value;
      const mensaje = document.getElementById('mensaje');

      const credencialesValidas = [
        { usuario: "admin", contrasena: "1234" },
        { usuario: "felix", contrasena: "1234" }
      ];

      const accesoPermitido = credencialesValidas.some(cred => cred.usuario === user && cred.contrasena === pass);

      if (accesoPermitido) {
        document.getElementById('login').style.display = "none";
        document.getElementById('cargando').style.display = "block";
        setTimeout(() => {
          document.getElementById('cargando').style.display = "none";
          document.getElementById('contenido').style.display = "block";
        }, 1000);
      } else {
        mensaje.textContent = "Credenciales incorrectas.";
      }
    }

    function eliminarFila(btn) {
      const fila = btn.closest("tr");
      fila.remove();
    }

    function agregarRegistro() {
      const tabla = document.getElementById('inventario').getElementsByTagName('tbody')[0];
      const fila = tabla.insertRow();

      const campos = ['fechaEntrada', 'equipo', 'imel', 'problema', 'cliente', 'cedula', 'tecnico', 'fechaSalida'];

      campos.forEach(id => {
        const celda = fila.insertCell();
        celda.textContent = document.getElementById(id).value;
      });

      const celdaAccion = fila.insertCell();
      celdaAccion.innerHTML = `<button class="eliminar" onclick="eliminarFila(this)">Eliminar</button>`;

      // Limpia los campos
      campos.forEach(id => document.getElementById(id).value = "");
    }

    function exportTableToExcel(tableID, filename = '') {
      const downloadLink = document.createElement('a');
      const dataType = 'application/vnd.ms-excel';
      const tableSelect = document.getElementById(tableID);
      const tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');

      filename = filename ? filename + '.xls' : 'excel_data.xls';

      downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
      downloadLink.download = filename;

      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);
    }
  </script>
</body>
</html>

